<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      FFmpeg-7.1.1
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
    <link rel="icon" href="../images/favicon.ico" type="image/x-icon" />
  </head>
  <body class="blfs" id="blfs-#75161">
    <div class="navheader">
      <h4>
        Gaming Linux<sup>®</sup> From Scratch <span class=
        "phrase">(Systemd</span> Edition) - Version #75161
      </h4>
      <h3>
        Chapter&nbsp;17.&nbsp;Gst
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="x265.html" title="x265-4.1">Prev</a>
          <p>
            x265-4.1
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="gstreamer-suite.html" title=
          "GStreamer Suite 1.26.2">Next</a>
          <p>
            GStreamer Suite 1.26.2
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="gst.html" title=
          "Chapter&nbsp;17.&nbsp;Gst">Up</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "  Gaming Linux® From Scratch  (Systemd  Edition)  - Version #75161">
          Home</a>
        </li>
      </ul>
    </div>
    <h1 class="sect1">
      <a id="ffmpeg" name="ffmpeg"></a>FFmpeg-7.1.1
    </h1>
    <div class="sect1" lang="en" xml:lang="en">
      <div class="package" lang="en" xml:lang="en">
        <h2 class="sect2">
          Introduction to FFmpeg
        </h2>
        <p>
          <span class="application">FFmpeg</span> is a solution to record,
          convert and stream audio and video. It is a very fast video and
          audio converter and it can also acquire from a live audio/video
          source. Designed to be intuitive, the command-line interface
          (<span class="command"><strong>ffmpeg</strong></span>) tries to
          figure out all the parameters, when possible. <span class=
          "application">FFmpeg</span> can also convert from any sample rate
          to any other, and resize video on the fly with a high quality
          polyphase filter. <span class="application">FFmpeg</span> can use a
          Video4Linux compatible video source and any Open Sound System audio
          source.
        </p>
        <div class="itemizedlist">
          <ul class="compact">
            <li class="listitem">
              <p>
                Download (HTTP): <a class="ulink" href=
                "https://ffmpeg.org/releases/ffmpeg-7.1.1.tar.xz">https://ffmpeg.org/releases/ffmpeg-7.1.1.tar.xz</a>
              </p>
            </li>
          </ul>
        </div>
        <h3>
          Additional Downloads
        </h3>
        <div class="itemizedlist">
          <ul class="compact">
            <li class="listitem">
              <p>
                Required patch: <a class="ulink" href=
                "https://glfs-book.github.io/glfs/download/ffmpeg/ffmpeg-7.1.1-chromium_method-1.patch">
                https://glfs-book.github.io/glfs/download/ffmpeg/ffmpeg-7.1.1-chromium_method-1.patch</a>
              </p>
            </li>
          </ul>
        </div>
        <h3>
          FFmpeg Dependencies
        </h3>
        <h4>
          Required
        </h4>
        <p class="required">
          <a class="xref" href="../introduction/pkgconf.html" title=
          "Pkgconf Personalties">Pkgconf Personalties</a> (for lib32)
        </p>
        <h4>
          Recommended
        </h4>
        <p class="recommended">
          <a class="xref" href="libaom.html" title=
          "libaom-3.12.1">libaom-3.12.1</a>, <a class="ulink" href=
          "https://www.linuxfromscratch.org/blfs/view/systemd/multimedia/libass.html">
          libass</a>, <a class="xref" href="fdk-aac.html" title=
          "fdk-aac-2.0.3">fdk-aac-2.0.3</a>, <a class="xref" href=
          "../shareddeps/freetype2-pass2.html" title=
          "FreeType-2.13.3 - Pass 2">FreeType-2.13.3 - Pass 2</a>, <a class=
          "xref" href="lame.html" title="LAME-3.100">LAME-3.100</a>,
          <a class="xref" href="../shareddeps/libvorbis.html" title=
          "libvorbis-1.3.7">libvorbis-1.3.7</a>, <a class="xref" href=
          "libvpx.html" title="libvpx-1.15.2">libvpx-1.15.2</a>, <a class=
          "xref" href="../shareddeps/opus.html" title=
          "Opus-1.5.2">Opus-1.5.2</a>, <a class="xref" href="x264.html"
          title="x264-20240812">x264-20240812</a>, <a class="xref" href=
          "x265.html" title="x265-4.1">x265-4.1</a>, and <a class="xref"
          href="nasm.html" title="NASM-2.16.03">NASM-2.16.03</a>
        </p>
        <h4>
          Recommended for desktop use
        </h4>
        <p class="recommended">
          <a class="xref" href="../shareddeps/alsa-lib.html" title=
          "alsa-lib-1.2.14">alsa-lib-1.2.14</a>, <a class="xref" href=
          "../shareddeps/libva.html" title="libva-2.22.0">libva-2.22.0</a>,
          and <a class="xref" href="sdl2.html" title=
          "SDL2-2.32.8">SDL2-2.32.8</a>
        </p>
        <h4>
          Recommended for systems with Intel Video
        </h4>
        <p class="recommended">
          <a class="xref" href="../shareddeps/libvdpau.html" title=
          "libvdpau-1.5">libvdpau-1.5</a> and <a class="xref" href=
          "../shareddeps/libvdpau-va-gl.html" title=
          "libvdpau-va-gl-0.4.2">libvdpau-va-gl-0.4.2</a>
        </p>
        <h4>
          Optional for systems with NVIDIA
        </h4>
        <p class="optional">
          <a class="ulink" href=
          "https://glfs-book.github.io/slfs/general/cuda.html">CUDA</a> and
          <a class="ulink" href=
          "https://glfs-book.github.io/slfs/general/nv-codec-headers.html">nv-codec-headers</a>
        </p>
        <h4>
          Optional
        </h4>
        <p class="optional">
          Full list of optional dependencies are in the <a class="ulink"
          href="https://www.linuxfromscratch.org/blfs/view/systemd/multimedia/ffmpeg.html">
          BLFS FFmpeg page</a>.
        </p>
      </div>
      <div class="installation" lang="en" xml:lang="en">
        <h2 class="sect2">
          Installation of FFmpeg
        </h2>
        <p>
          First, apply a patch that adds an API necessary for some packages
          to build:
        </p>
        <pre class="userinput"><kbd class=
        "command">patch -Np1 -i ../ffmpeg-7.1.1-chromium_method-1.patch</kbd></pre>
        <p>
          Now fix an issue caused by the latest version of <a class="xref"
          href="x265.html" title="x265-4.1">x265-4.1</a>:
        </p>
        <pre class="userinput"><kbd class=
        "command">sed -e 's/X265_BUILD &gt;= 210/(&amp;) \&amp;\&amp; (X265_BUILD &lt; 213)/' \
    -i libavcodec/libx265.c</kbd></pre>
        <p>
          Install <span class="application">FFmpeg</span> by running the
          following commands:
        </p>
        <pre class="userinput"><kbd class=
        "command">./configure --prefix=/usr        \
            --enable-gpl         \
            --enable-version3    \
            --enable-nonfree     \
            --disable-static     \
            --enable-shared      \
            --disable-debug      \
            --enable-libaom      \
            --enable-libfdk-aac  \
            --enable-libfreetype \
            --enable-libmp3lame  \
            --enable-libopus     \
            --enable-libvorbis   \
            --enable-libvpx      \
            --enable-libx264     \
            --enable-libx265     \
            --enable-openssl     \
            --ignore-tests=enhanced-flv-av1 \
            --docdir=/usr/share/doc/ffmpeg-7.1.1 &amp;&amp;

make &amp;&amp;

gcc tools/qt-faststart.c -o tools/qt-faststart</kbd></pre>
        <p>
          Now, as the <code class="systemitem">root</code> user:
        </p>
        <pre class="root"><kbd class="command">make install &amp;&amp;

install -v -m755    tools/qt-faststart /usr/bin &amp;&amp;
install -v -m755 -d           /usr/share/doc/ffmpeg-7.1.1 &amp;&amp;
install -v -m644    doc/*.txt /usr/share/doc/ffmpeg-7.1.1</kbd></pre>
      </div>
      <div class="installation" lang="en" xml:lang="en">
        <h2 class="sect2">
          lib32 Installation of FFmpeg
        </h2>
        <p>
          Install lib32-<span class="application">FFmpeg</span> by running
          the following commands:
        </p>
        <pre class="userinput"><kbd class="command">make distclean &amp;&amp;
./configure --prefix=/usr                             \
            --libdir=/usr/lib32                       \
            --shlibdir=/usr/lib32                     \
            --cc="gcc -m32"                           \
            --pkg-config=i686-pc-linux-gnu-pkg-config \
            --enable-gpl                              \
            --enable-version3                         \
            --enable-nonfree                          \
            --disable-static                          \
            --enable-shared                           \
            --disable-debug                           \
            --enable-libaom                           \
            --enable-libfdk-aac                       \
            --enable-libfreetype                      \
            --enable-libmp3lame                       \
            --enable-libopus                          \
            --enable-libvorbis                        \
            --enable-libvpx                           \
            --enable-libx264                          \
            --enable-libx265                          \
            --enable-openssl                          \
            --ignore-tests=enhanced-flv-av1 &amp;&amp;

make</kbd></pre>
        <p>
          Now, as the <code class="systemitem">root</code> user:
        </p>
        <pre class="root"><kbd class=
        "command">make DESTDIR=$PWD/DESTDIR install     &amp;&amp;
cp -vr DESTDIR/usr/lib32/* /usr/lib32 &amp;&amp;
rm -rf DESTDIR                        &amp;&amp;
ldconfig</kbd></pre>
      </div>
      <div class="commands" lang="en" xml:lang="en">
        <h2 class="sect2">
          Command Explanations
        </h2>
        <div class="admon note">
          <img alt="[Note]" src="../images/note.png" />
          <h3>
            Note
          </h3>
          <p>
            Run <span class="command"><strong>./configure
            --help</strong></span> for a full list of options.
          </p>
        </div>
        <p>
          <em class="parameter"><code>--enable-libfreetype</code></em>:
          Enables <span class="application">Freetype</span> support.
        </p>
        <p>
          <em class="parameter"><code>--enable-gpl</code></em>: Enables the
          use of GPL code and permits support for postprocessing, swscale and
          many other features.
        </p>
        <p>
          <em class="parameter"><code>--enable-version3</code></em>: Enables
          the use of (L)GPL version 3 code.
        </p>
        <p>
          <em class="parameter"><code>--enable-nonfree</code></em>: Enables
          the use of nonfree code. Note that the resulting libraries and
          binaries will be unredistributable.
        </p>
        <p>
          <em class="parameter"><code>--disable-static</code></em>: This
          switch prevents installation of static versions of the libraries.
        </p>
        <p>
          <em class="parameter"><code>--enable-shared</code></em>: Enables
          building shared libraries, otherwise only static libraries are
          built and installed.
        </p>
        <p>
          <em class="parameter"><code>--disable-debug</code></em>: Disables
          building debugging symbols into the programs and libraries.
        </p>
        <p>
          <em class="parameter"><code>--enable-libaom</code></em>: Enables
          AV1 audio and video decoding via <code class=
          "filename">libaom</code>.
        </p>
        <p>
          <em class="parameter"><code>--enable-libfdk-aac</code></em>:
          Enables AAC audio encoding via <code class=
          "filename">libfdk-aac</code>.
        </p>
        <p>
          <em class="parameter"><code>--enable-libmp3lame</code></em>:
          Enables MP3 audio encoding via <code class=
          "filename">libmp3lame</code>.
        </p>
        <p>
          <em class="parameter"><code>--enable-libvorbis</code></em>
          <em class="parameter"><code>--enable-libvpx</code></em>: Enables
          WebM encoding via <code class="filename">libvorbis</code> and
          <code class="filename">libvpx</code>.
        </p>
        <p>
          <em class="parameter"><code>--enable-libx264</code></em>: Enables
          high-quality H.264/MPEG-4 AVC encoding via <code class=
          "filename">libx264</code>.
        </p>
        <p>
          <em class="parameter"><code>--enable-libx265</code></em>: Enables
          high-quality H.265/HEVC encoding via <code class=
          "filename">libx265</code>.
        </p>
        <p>
          <em class="parameter"><code>--enable-openssl</code></em>: Enables
          HTTPS protocol for network streams.
        </p>
        <p>
          <code class="option">--enable-libdrm</code>: Use this switch if
          <a class="xref" href="../shareddeps/libdrm.html" title=
          "Libdrm-2.4.125">libdrm-2.4.125</a> is installed to build the
          <span class="quote">“<span class="quote">kmsgrab</span>”</span>
          input module which is useful for screen capturing or streaming.
        </p>
        <p>
          <code class="option">--enable-nvenc --enable-nvdec</code>: These
          options enable hardware acceleration for NVIDIA GPUs, and depend on
          the optional dependencies for systems with NVIDIA.
        </p>
        <p>
          <em class="parameter"><code>--ignore-tests=...</code></em>:
          Disables tests that fail to run on BLFS without the optional
          packages. Currently the AV1 test is disabled as it needs dav1d to
          do AV1 decoding on the CPU. The test might work if you have a GPU
          that can decode AV1, but this was not tested.
        </p>
        <p>
          <code class="option">--enable-gnutls</code>: Use this option
          instead of <em class=
          "parameter"><code>--enable-openssl</code></em>, if you want to use
          <span class="application">GnuTLS</span> instead of <span class=
          "application">OpenSSL</span> for HTTPS protocol.
        </p>
        <p>
          <code class="option">--disable-doc</code>: Disables building html
          documentation. This is only needed if doxygen is installed and you
          do not want to build the html documentation.
        </p>
        <p>
          <code class="option">--enable-libpulse</code>: Enables support for
          <span class="application">Pulseaudio</span> for audio output.
        </p>
        <p>
          <span class="command"><strong>gcc tools/qt-faststart.c -o
          tools/qt-faststart</strong></span>: This builds the <span class=
          "command"><strong>qt-faststart</strong></span> program which can
          modify QuickTime formatted movies (<code class=
          "filename">.mov</code> or <code class="filename">.mp4</code>) so
          that the header information is located at the beginning of the file
          instead of the end. This allows the movie file to begin playing
          before the entire file has been downloaded.
        </p>
        <div class="admon note">
          <img alt="[Note]" src="../images/note.png" />
          <h3>
            Note
          </h3>
          <p>
            Support for some of the dependency packages requires using
            options passed to the <span class=
            "command"><strong>configure</strong></span> script. View the
            output from <span class="command"><strong>./configure
            --help</strong></span> for complete information about enabling
            dependency packages.
          </p>
        </div>
      </div>
      <div class="content" lang="en" xml:lang="en">
        <h2 class="sect2">
          Contents
        </h2>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">Installed Programs:</strong>
              <span class="segbody">ffmpeg, ffplay, ffprobe, and
              qt-faststart</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Installed Libraries:</strong>
              <span class="segbody">libavcodec, libavdevice, libavfilter,
              libavformat, libavutil, libpostproc, libswresample, and
              libswscale</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Installed Directories:</strong>
              <span class=
              "segbody">/usr/include/libav{codec,device,filter,format,util},
              /usr/include/libpostproc, /usr/include/libsw{resample,scale},
              /usr/share/doc/ffmpeg-7.1.1, and /usr/share/ffmpeg</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            Short Descriptions
          </h3>
          <table border="0" class="variablelist">
            <colgroup>
              <col align="left" valign="top" />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="ffmpeg-prog" name="ffmpeg-prog"></a><span class=
                    "term"><span class=
                    "command"><strong>ffmpeg</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    is a command-line tool to convert video files, network
                    streams and input from a TV card to several video formats
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="ffplay" name="ffplay"></a><span class=
                    "term"><span class=
                    "command"><strong>ffplay</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    is a very simple and portable media player using the
                    <code class="filename">ffmpeg</code> libraries and the
                    SDL library
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="ffprobe" name="ffprobe"></a><span class=
                    "term"><span class=
                    "command"><strong>ffprobe</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    gathers information from multimedia streams and prints it
                    in a human and machine-readable fashion
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="qt-faststart" name="qt-faststart"></a><span class=
                    "term"><span class=
                    "command"><strong>qt-faststart</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    moves the index file to the front of quicktime (mov/mp4)
                    videos
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="libavcodec" name="libavcodec"></a><span class=
                    "term"><code class="filename">libavcodec</code></span>
                  </p>
                </td>
                <td>
                  <p>
                    is a library containing the <span class=
                    "application">FFmpeg</span> codecs (both encoding and
                    decoding)
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="libavdevice" name="libavdevice"></a><span class=
                    "term"><code class="filename">libavdevice</code></span>
                  </p>
                </td>
                <td>
                  <p>
                    is the <span class="application">FFmpeg</span> device
                    handling library
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="libavfilter" name="libavfilter"></a><span class=
                    "term"><code class="filename">libavfilter</code></span>
                  </p>
                </td>
                <td>
                  <p>
                    is a library of filters that can alter video or audio
                    between the decoder and the encoder (or output)
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="libavformat" name="libavformat"></a><span class=
                    "term"><code class="filename">libavformat</code></span>
                  </p>
                </td>
                <td>
                  <p>
                    is a library containing the file formats handling (mux
                    and demux code for several formats) used by <span class=
                    "command"><strong>ffplay</strong></span> as well as
                    allowing the generation of audio or video streams
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="libavresample" name=
                    "libavresample"></a><span class="term"><code class=
                    "filename">libavresample</code></span>
                  </p>
                </td>
                <td>
                  <p>
                    is a library containing functions for resampling audio
                    and video.
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="libavutil" name="libavutil"></a><span class=
                    "term"><code class="filename">libavutil</code></span>
                  </p>
                </td>
                <td>
                  <p>
                    is the <span class="application">FFmpeg</span> utility
                    library
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="libpostproc" name="libpostproc"></a><span class=
                    "term"><code class="filename">libpostproc</code></span>
                  </p>
                </td>
                <td>
                  <p>
                    is the <span class="application">FFmpeg</span> post
                    processing library
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="libswresample" name=
                    "libswresample"></a><span class="term"><code class=
                    "filename">libswresample</code></span>
                  </p>
                </td>
                <td>
                  <p>
                    is the <span class="application">FFmpeg</span> audio
                    rescaling library, it contains functions for converting
                    audio sample formats
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="libswscale" name="libswscale"></a><span class=
                    "term"><code class="filename">libswscale</code></span>
                  </p>
                </td>
                <td>
                  <p>
                    is the <span class="application">FFmpeg</span> image
                    rescaling library
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="x265.html" title="x265-4.1">Prev</a>
          <p>
            x265-4.1
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="gstreamer-suite.html" title=
          "GStreamer Suite 1.26.2">Next</a>
          <p>
            GStreamer Suite 1.26.2
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="gst.html" title=
          "Chapter&nbsp;17.&nbsp;Gst">Up</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "  Gaming Linux® From Scratch  (Systemd  Edition)  - Version #75161">
          Home</a>
        </li>
      </ul>
    </div>
  </body>
</html>
